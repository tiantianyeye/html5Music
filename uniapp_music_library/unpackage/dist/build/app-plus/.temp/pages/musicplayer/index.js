require("../../common/manifest.js");
require("../../common/vendor.js");
global.webpackJsonp([4],{36:function(t,i,n){"use strict";var s=a(n(2)),e=a(n(37));function a(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(e.default))},37:function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=n(39),e=n.n(s),a=n(40);var o=function(t){n(38)},r=n(0)(e.a,a.a,o,"data-v-1739ef05",null);i.default=r.exports},38:function(t,i){},39:function(t,i,n){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0});var s=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},e=n(6),a=n(3),o=n(4);i.default={data:function(){return{songDetail:"",chooseIndex:0,currentTime:0,tempCurrentTime:0,dealTotalTime:0,bgAudioMannager:"",topDistance:0}},onShow:function(){this.chooseIndex=this.$root.$mp.query.index;t.setNavigationBarTitle({title:this.musicDetailInfo.audio_name}),this.bgAudioMannager=this.globalData.bgAudioMannager,this.dealTotalTime=(0,a.secondToMinute)(this.musicDetailInfo.timelength),this.setBgMusic(),this.setMusicMonitor()},computed:s({},(0,e.mapGetters)(["songList","musicDetailInfo","isPlaying"]),{dealCurrentTime:function(){return(0,a.secondToMinute)(this.currentTime)},currentPrecent:function(){return this.dealCurrentTime?Math.round(100*this.currentTime/this.musicDetailInfo.timelength):0},lyricsArr:function(){var t=[],i=[];return this.musicDetailInfo.lyrics.split("[").slice(1).map(function(n,s){var e=(n=n.trim().split("]"))[0].split(":"),a=60*Number(e[0])*1e3+1e3*Number(e[1].split(".")[0])+Number(e[1].split(".")[1]);t.push(a),i.push(n[1])}),{timeArrs:t,lyricsList:i}}}),methods:{setBgMusic:function(){var t=this.musicDetailInfo;this.bgAudioMannager.title=t.song_name,this.bgAudioMannager.singer=t.author_name,this.bgAudioMannager.coverImgUrl=t.img,this.bgAudioMannager.src=t.play_url},getSongDetailInfo:function(t){var i=this;i.chooseIndex=t;var n=i.songList[t].FileHash;(0,a.get)(o.playUrl,{r:"play/getdata",hash:n}).then(function(t){i.$store.dispatch("setSongDetailInfo",t),i.playMusic()})},playMusic:function(){this.$store.dispatch("setMusicPlay");var t=this.musicDetailInfo;this.bgAudioMannager.stop(),this.bgAudioMannager.title=t.song_name,this.bgAudioMannager.singer=t.author_name,this.bgAudioMannager.coverImgUrl=t.img,this.bgAudioMannager.src=t.play_url,this.bgAudioMannager.play()},prevSong:function(){var t=this.chooseIndex-1;t=t<0?0:t,this.getSongDetailInfo(t)},nextSong:function(){var t=this.chooseIndex+1;t=t>=this.songList.length?0:t,this.getSongDetailInfo(t)},isRewind:function(t){if(this.isPlaying){var i,n=this.bgAudioMannager.currentTime;t?(n=(n-=5)<0?0:n,i="快退5s"):(n=(n+=5)>this.bgAudioMannager.duration?this.bgAudioMannager.duration:n,i="快进5s"),this.bgAudioMannager.seek(n),(0,a.showToast)(i)}},onMusicTap:function(){this.isPlaying?(this.bgAudioMannager.pause(),this.$store.dispatch("setMusicPause")):(this.bgAudioMannager.play(),this.$store.dispatch("setMusicPlay"))},setMusicMonitor:function(){var t=this,i=this;this.bgAudioMannager.onPlay(function(){i.$store.dispatch("setMusicPlay")}),this.bgAudioMannager.onPause(function(){i.$store.dispatch("setMusicPause")}),this.bgAudioMannager.onPrev(function(){i.prevSong()}),this.bgAudioMannager.onNext(function(){i.nextSong()}),this.bgAudioMannager.onTimeUpdate(function(){i.currentTime=1e3*i.bgAudioMannager.currentTime,i.currentTime>4e3&&t.tempCurrentTime!=t.currentTime&&(i.tempCurrentTime=i.currentTime,i.lyricsArr.timeArrs.forEach(function(t,n){parseInt(t/1e3)!=parseInt(i.currentTime/1e3)||(i.topDistance=-25*(n-4))}))}),this.bgAudioMannager.onEnded(function(){i.$store.dispatch("setMusicPause");var t=i.chooseIndex+1;t=t>=i.songList.length?0:t,i.chooseIndex=t,i.getSongDetailInfo(t)})},downloadSong:function(){var i=this.musicDetailInfo.play_url;t.showModal({title:"音乐下载地址",content:i,showCancel:!0,confirmText:"复制",success:function(n){n.confirm&&t.setClipboardData({data:i,success:function(){(0,a.showToast)("复制成功","success")},fail:function(){(0,a.showToast)("复制失败，请重新复制")}})}})}}}}).call(i,n(1).default)},40:function(t,i,n){"use strict";var s={render:function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{staticClass:"musicplayer-div"},[n("image",{staticClass:"bgImg",attrs:{src:t.musicDetailInfo.img}}),n("div",{staticClass:"music-div"},[n("div",{staticClass:"geci-div"},[n("div",{staticClass:"pos-div",style:{top:t.topDistance+"px"}},t._l(t.lyricsArr.lyricsList,function(i,s,e){return n("p",{key:e,class:{active:s<t.lyricsArr.lyricsList.length-1?t.currentTime>3e3&&t.currentTime>=t.lyricsArr.timeArrs[s]&&t.currentTime<=t.lyricsArr.timeArrs[s+1]:t.currentTime>t.lyricsArr.timeArrs[s]}},[t._v("\n\t\t\t\t\t"+t._s(i)+"\n\t\t\t\t")])}))])]),n("div",{staticClass:"controls-group-div"},[n("div",{staticClass:"progress-div"},[n("span",[t._v(t._s(t.dealCurrentTime))]),n("progress",{attrs:{percent:t.currentPrecent,"stroke-width":"5",backgroundColor:"#dcdcdc",activeColor:"#3195fd"}}),n("span",[t._v(t._s(t.dealTotalTime))])],1),n("div",{staticClass:"control-div"},[n("div",{staticClass:"space"}),n("div",{staticClass:"control-btn"},[n("i",{staticClass:"iconfont icon-kuaijin-copy",attrs:{eventid:"vGF-0"},on:{click:function(i){i.stopPropagation(),t.prevSong(i)}}}),n("i",{staticClass:"iconfont icon-shangyishou",attrs:{eventid:"o0P-1"},on:{click:function(i){i.stopPropagation(),t.isRewind(!0)}}}),n("i",{staticClass:"iconfont icon-Icon-pause",class:[t.isPlaying?"icon-Icon-pause":"icon-zanting"],attrs:{eventid:"Snl-2"},on:{click:function(i){i.stopPropagation(),t.onMusicTap(i)}}}),n("i",{staticClass:"iconfont icon-kuaijin1",attrs:{eventid:"uav-3"},on:{click:function(i){i.stopPropagation(),t.isRewind(!1)}}}),n("i",{staticClass:"iconfont icon-kuaijin",attrs:{eventid:"lQ0-4"},on:{click:function(i){i.stopPropagation(),t.nextSong(i)}}})],1),n("i",{staticClass:"iconfont icon-xiazai download",attrs:{eventid:"gsq-5"},on:{click:function(i){i.stopPropagation(),t.downloadSong(i)}}})],1)])])},staticRenderFns:[]};i.a=s}},[36]);